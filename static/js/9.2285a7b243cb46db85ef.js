webpackJsonp([9],{uxfR:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("lbHh");var o=a("mtWM"),i=a.n(o);a("uXZL"),a("VI/i");i.a.defaults.withCredentials=!0;var s={data:function(){return{sels:[],multipleSelection:[],dialogVisible:!1,dialogVisible1:!1,form:{},form1:{},companyList:[],positionList:[{positionId:0,label:"员工"},{positionId:1,label:"经理"},{positionId:2,label:"负责人"}],typeList:[{type:0,label:"管理部门"},{type:1,label:"消费者"},{type:2,label:"农户"},{type:3,label:"企业"},{type:4,label:"科研机构"},{type:5,label:"行业协会"},{type:6,label:"其他产业链"}],tableData:[],tableHeader:["姓名","手机","企业","角色"],idCard:""}},mounted:function(){var t=this;this.tableData;i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageNum:10}).then(function(e){t.tableData=[],console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var o=0;o<e.data.data.list[a].relationships.length;o++){var i={username:e.data.data.list[a].username,userId:e.data.data.list[a].userId,type:e.data.data.list[a].type,"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[o].enterpriseName,"角色":e.data.data.list[a].relationships[o].position};t.tableData.push(i)}}).catch(function(t){console.log("error")})},methods:{selsChange:function(t){this.sels=t},openSel:function(){this.dialogVisible1=!0},setAll:function(){var t=this;console.log(666),console.log(this.sels);var e=this.sels.length,a=this.sels;console.log(this.form1);for(var o=0;o<e;o++)console.log(a[o].userId),"员工"===this.form1.resource?i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:a[o].userId,position:0}).then(function(t){}).catch(function(t){console.log("error")}):"经理"===this.form1.resource?i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:a[o].userId,position:1}).then(function(t){}).catch(function(t){console.log("error")}):"负责人"===this.form1.resource&&i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:a[o].userId,position:2}).then(function(t){}).catch(function(t){console.log("error")}),i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageNum:10}).then(function(e){t.tableData=[];for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var o=0;o<e.data.data.list[a].relationships.length;o++){var i={username:e.data.data.list[a].username,userId:e.data.data.list[a].userId,type:e.data.data.list[a].type,"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[o].enterpriseName,"角色":e.data.data.list[a].relationships[o].position};t.tableData.push(i)}}).catch(function(t){console.log("error")}),this.dialogVisible1=!1},deleteAlert:function(t,e){var a=this;this.$confirm("此操作将永久删除该帐户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){i.a.defaults.withCredentials=!0,i.a.get("http://120.79.185.173:8080/agriculture/backend/user/userDel.do",{userId:e[t].userId}).then(function(t){0===t.data.status?a.$message({type:"success",message:"删除成功!"}):a.$message({type:"warning",message:"删除失败!需要管理员权限"})}).catch(function(t){a.$message({type:"warning",message:"删除失败!需要管理员权限"}),console.log("error")})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},openForm:function(t,e){this.dialogVisible=!0,this.idCard="",this.idCard=e[t].userId},setPosition:function(){var t=this;"员工"===this.form.resource?i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:this.idCard,position:0}).then(function(t){}).catch(function(t){console.log("error")}):"经理"===this.form.resource?i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:this.idCard,position:1}).then(function(t){}).catch(function(t){console.log("error")}):"负责人"===this.form.resource&&i.a.post("http://120.79.185.173:8080/agriculture/backend/user/positionUpdate.do",{id:this.idCard,position:2}).then(function(t){}).catch(function(t){console.log("error")}),i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageNum:10}).then(function(e){t.tableData=[];for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var o=0;o<e.data.data.list[a].relationships.length;o++){var i={username:e.data.data.list[a].username,userId:e.data.data.list[a].userId,type:e.data.data.list[a].type,"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[o].enterpriseName,"角色":e.data.data.list[a].relationships[o].position};t.tableData.push(i)}}).catch(function(t){console.log("error")}),this.dialogVisible=!1}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-button",{on:{click:t.openSel}},[t._v("批量分配")])],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,"header-cell-style":{background:"#1ca291",color:"#ffffff"},border:"","highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),t._l(t.tableHeader,function(t){return a("el-table-column",{key:t.id,attrs:{prop:t,label:t}})}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.deleteAlert(e.$index,t.tableData)}}},[t._v("\n          移除\n        ")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.openForm(e.$index,t.tableData)}}},[t._v("分配角色")])]}}])})],2),t._v(" "),a("el-dialog",{attrs:{title:"分配角色",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:""}},[a("el-radio-group",{model:{value:t.form.resource,callback:function(e){t.$set(t.form,"resource",e)},expression:"form.resource"}},[a("el-radio",{attrs:{label:"员工",prop:"0"}}),t._v(" "),a("el-radio",{attrs:{label:"经理"}}),t._v(" "),a("el-radio",{attrs:{label:"负责人"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.setPosition}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"分配角色",visible:t.dialogVisible1,width:"30%"},on:{"update:visible":function(e){t.dialogVisible1=e}}},[a("el-form",{ref:"form1",attrs:{model:t.form1,"label-width":"80px"}},[a("el-form-item",{attrs:{label:""}},[a("el-radio-group",{model:{value:t.form1.resource,callback:function(e){t.$set(t.form1,"resource",e)},expression:"form1.resource"}},[a("el-radio",{attrs:{label:"员工",prop:"0"}}),t._v(" "),a("el-radio",{attrs:{label:"经理"}}),t._v(" "),a("el-radio",{attrs:{label:"负责人"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible1=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.setAll}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]},r=a("VU/8")(s,l,!1,null,null,null);e.default=r.exports}});
//# sourceMappingURL=9.2285a7b243cb46db85ef.js.map
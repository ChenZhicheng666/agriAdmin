webpackJsonp([6],{"Kng+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lbHh"),l=a.n(s),r=a("mtWM"),i=a.n(r),n=a("iiAv"),o=a("uXZL"),d=a.n(o),u=a("VI/i"),p=a.n(u);i.a.defaults.withCredentials=!0;var c={data:function(){var t=function(t,e,a){e.length<11?a(new Error("请输入正确的手机号码")):a()};return{sels:[],rules:{username:[{required:!0,message:"输入不能为空"}],password:[{required:!0,message:"输入不能为空"}],type:[{required:!0,message:"输入不能为空"}],phonenum:[{required:!0,message:"输入不能为空"},{required:!0,trigger:"blur",validator:t},{required:!0,trigger:"change",validator:t}]},notType:!0,firstId0:[],companyList:[],positionList:[{positionId:0,label:"员工"},{positionId:1,label:"经理"},{positionId:2,label:"负责人"}],typeList:[{type:0,label:"管理部门"},{type:1,label:"消费者"},{type:2,label:"农户"},{type:3,label:"企业"},{type:4,label:"科研机构"},{type:5,label:"行业协会"},{type:6,label:"其他产业链"}],test:!1,selVisible:!1,dialogVisible:!1,form:{},tableData:[],tableHeader:["姓名","手机","企业","角色"]}},mounted:function(){var t=this;i.a.post("http://120.79.185.173:8080/agriculture/backend/enterprise/enterpriseGet.do",{status:1,pageSize:1e4,pageNum:1},{withCredentials:!0}).then(function(e){t.companyList=[];for(var a=0;a<e.data.data.list.length;a++){var s={enterpriseId:e.data.data.list[a].id,enterpriseName:e.data.data.list[a].name};t.companyList.push(s)}},function(t){console.log("error")});this.tableData;if("1"===l.a.get("limit")){this.tableData=[],i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++)if(Object(n.a)(e.data.data.list[a].relationships[s].enterpriseName)){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};console.log(l),t.tableData.push(l)}}).catch(function(){console.log("error")})}else{this.tableData;i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};t.tableData.push(l)}else{l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":"个人种植户",userId:e.data.data.list[a].userId};t.tableData.push(l)}}).catch(function(){console.log("error")})}},methods:{selsChange:function(t){this.sels=t},delAll:function(){var t=this,e=this.sels.length,a=this.sels;this.$confirm("此操作将永久删除该文件及其子文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var s=0;s<e;s++)i.a.get("http://120.79.185.173:8080/agriculture/backend/user/userDel.do?userId="+a[s].userId).then(function(e){if("1"===l.a.get("limit")){t.tableData=[],i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++)if(Object(n.a)(e.data.data.list[a].relationships[s].enterpriseName)){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};console.log(l),t.tableData.push(l)}}).catch(function(){console.log("error")})}else{t.tableData;i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};t.tableData.push(l)}else{l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":"个人种植户",userId:e.data.data.list[a].userId};t.tableData.push(l)}}).catch(function(){console.log("error")})}t.$message({type:"success",message:"删除成功!"})}).catch(function(e){t.$message({type:"warning",message:"删除失败!需要管理员权限"}),console.log("error")})}),this.dialogVisible=!1},setDisabled:function(){3===this.form.type?this.notType=!1:(this.notType=!0,this.form.company="",this.form.role="")},deleteFileOrDirectory:function(){this.sels.map(function(t){return t.id}).join();this.$confirm("此操作将永久删除该文件及其子文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("删除成功")})},renderAddRow:function(){var t=this,e=p.a.createHash("md5");e.update(this.form.password);var a=e.digest("hex"),s={username:this.form.username,phonenum:this.form.phonenum,password:a,type:this.form.type,enterprise:this.form.company,position:this.form.role};i.a.post("http://120.79.185.173:8080/agriculture/portal/user/apply.do",s).then(function(e){console.log(e.data.data.userId);var a={userId:e.data.data.userId,enterpriseId:t.form.company,position:t.form.role};if(3===t.form.type&&i.a.post("http://120.79.185.173:8080/agriculture/backend/enterprise/enterpriseJoin.do",a).then(function(e){console.log(e.data),t.$message({type:"success",message:"已申请加入企业"})}).catch(function(e){t.$message({type:"warning",message:"加入企业失败,需要管理员权限"}),console.log("error")}),"1"===l.a.get("limit")){t.tableData=[],i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++)if(Object(n.a)(e.data.data.list[a].relationships[s].enterpriseName)){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};console.log(l),t.tableData.push(l)}}).catch(function(){console.log("error")})}else{t.tableData;i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(e){console.log(e.data);for(var a=0;a<e.data.data.list.length;a++)if(e.data.data.list[a].relationships.length>0)for(var s=0;s<e.data.data.list[a].relationships.length;s++){var l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":e.data.data.list[a].relationships[s].enterpriseName,"角色":e.data.data.list[a].relationships[s].position,userId:e.data.data.list[a].userId};t.tableData.push(l)}else{l={"姓名":e.data.data.list[a].username,"手机":e.data.data.list[a].phonenum,"企业":"个人种植户",userId:e.data.data.list[a].userId};t.tableData.push(l)}}).catch(function(){console.log("error")})}t.$message({type:"success",message:"添加成功"})}).catch(function(e){t.$message({type:"warning",message:"添加失败"}),console.log("error")}),this.dialogVisible=!1},deleteAlert:function(t,e){var a=this;this.$confirm("此操作将永久删除该帐户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){i.a.defaults.withCredentials=!0,i.a.get("http://120.79.185.173:8080/agriculture/backend/user/userDel.do?userId="+e[t].userId).then(function(t){if(0===t.data.status){if("1"===l.a.get("limit")){a.tableData=[],i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(t){console.log(t.data);for(var e=0;e<t.data.data.list.length;e++)if(t.data.data.list[e].relationships.length>0)for(var s=0;s<t.data.data.list[e].relationships.length;s++)if(Object(n.a)(t.data.data.list[e].relationships[s].enterpriseName)){var l={"姓名":t.data.data.list[e].username,"手机":t.data.data.list[e].phonenum,"企业":t.data.data.list[e].relationships[s].enterpriseName,"角色":t.data.data.list[e].relationships[s].position,userId:t.data.data.list[e].userId};console.log(l),a.tableData.push(l)}}).catch(function(){console.log("error")})}else{a.tableData;i.a.post("http://120.79.185.173:8080/agriculture/backend/user/usersGet.do",{pageSize:1e3}).then(function(t){console.log(t.data);for(var e=0;e<t.data.data.list.length;e++)if(t.data.data.list[e].relationships.length>0)for(var s=0;s<t.data.data.list[e].relationships.length;s++){var l={"姓名":t.data.data.list[e].username,"手机":t.data.data.list[e].phonenum,"企业":t.data.data.list[e].relationships[s].enterpriseName,"角色":t.data.data.list[e].relationships[s].position,userId:t.data.data.list[e].userId};a.tableData.push(l)}else{l={"姓名":t.data.data.list[e].username,"手机":t.data.data.list[e].phonenum,"企业":"个人种植户",userId:t.data.data.list[e].userId};a.tableData.push(l)}}).catch(function(){console.log("error")})}a.dialogVisible=!1,a.$message({type:"success",message:"删除成功!"})}else a.$message({type:"warning",message:"删除失败!需要管理员权限"})}).catch(function(t){a.$message({type:"warning",message:"删除失败!需要管理员权限"}),console.log("error")})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteRow:function(t,e){e.splice(t,1)},handleFilePreview:function(t){this.handleFileChange(t)},handleFileChange:function(t,e){this.readerData(t.raw)},readerData:function(t){var e=this,a=new FileReader;a.onload=function(t){for(var a="",s=t.target.result,l=new Uint8Array(s),r=l.byteLength,i=0;i<r;i++)a+=String.fromCharCode(l[i]);var n=d.a.read(a,{type:"binary"}),o=n.SheetNames[0],u=n.Sheets[o],p=e.getHeaderRow(u),c=d.a.utils.sheet_to_json(u);e.generateDate({header:p,results:c})},a.readAsArrayBuffer(t)},generateDate:function(t){var e=t.header,a=t.results;this.tableHeader=e,this.tableData=a},fixdata:function(t){for(var e="",a=0,s=10240;a<t.byteLength/s;++a)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*s,a*s+s)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*s)))},getHeaderRow:function(t){var e=[],a=d.a.utils.decode_range(t["!ref"]),s=void 0,l=a.s.r;for(s=a.s.c;s<=a.e.c;++s){var r=t[d.a.utils.encode_cell({c:s,r:l})],i="UNKNOWN "+s;r&&r.t&&(i=d.a.utils.format_cell(r)),e.push(i)}return e}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-button",{attrs:{type:"success"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加")]),t._v(" "),a("el-upload",{staticClass:"inline",attrs:{action:"",multiple:!1,accept:".xlsx, .xls","on-change":t.handleFileChange,"on-preview":t.handleFilePreview,"auto-upload":!1}},[a("el-button",{attrs:{type:"success"}},[t._v("批量添加")])],1),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:t.delAll}},[t._v("批量删除")])],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,"header-cell-style":{background:"#1ca291",color:"#ffffff"},border:"","highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),t._l(t.tableHeader,function(t){return a("el-table-column",{key:t.id,attrs:{prop:t,label:t}})}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.deleteAlert(e.$index,t.tableData)}}},[t._v("\n          移除\n        ")])]}}])})],2),t._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"50px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[a("el-input",{staticStyle:{width:"230px"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{staticStyle:{width:"230px"},attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机",prop:"phonenum"}},[a("el-input",{staticStyle:{width:"230px"},model:{value:t.form.phonenum,callback:function(e){t.$set(t.form,"phonenum",e)},expression:"form.phonenum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-select",{attrs:{filterable:"","allow-create":"",placeholder:"请选择标签"},on:{change:t.setDisabled},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeList,function(t){return a("el-option",{key:t.type,attrs:{label:t.label,value:t.type}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"企业"}},[a("el-select",{attrs:{disabled:t.notType,filterable:"","allow-create":"",placeholder:"请选择标签"},model:{value:t.form.company,callback:function(e){t.$set(t.form,"company",e)},expression:"form.company"}},t._l(t.companyList,function(t){return a("el-option",{key:t.enterpriseId,attrs:{label:t.enterpriseName,value:t.enterpriseId}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:" 角色"}},[a("el-select",{attrs:{disabled:t.notType,clearable:"",filterable:"","allow-create":"",placeholder:"请选择标签"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},t._l(t.positionList,function(t){return a("el-option",{key:t.positionId,attrs:{label:t.label,value:t.positionId}})}),1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.renderAddRow}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=a("VU/8")(c,h,!1,function(t){a("kNuq")},null,null);e.default=f.exports},kNuq:function(t,e){}});
//# sourceMappingURL=6.d1b56f8efed43dbe1119.js.map